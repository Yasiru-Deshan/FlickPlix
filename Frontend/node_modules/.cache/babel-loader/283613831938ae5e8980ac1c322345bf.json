{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Dilanka Nirmal\\\\Downloads\\\\Y3S1\\\\SPM\\\\Assignment\\\\Origin_FlickPlix\\\\FlickPlix\\\\Frontend\\\\src\\\\components\\\\customerUserProfile\\\\customerUserProfile.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { getUser, removeUser } from '../../utils/common';\nimport '../../css/it19184722.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function CustomerUserProfile(props) {\n  _s();\n\n  const [fname, setfirstName] = useState(\"\");\n  const [lname, setlastName] = useState(\"\");\n  const [email, setemail] = useState(\"\");\n  const [address, setaddress] = useState(\"\");\n  const [pNo, setphone] = useState(\"\");\n  const id = getUser();\n  const [errors, seterrors] = useState([]);\n  const [emailerror, setemailerror] = useState(\"\");\n  const [loginMsg] = useState(localStorage.getItem(\"loginMsg\")); //this sets logout msg if any\n\n  const [success, setsuccess] = useState(\"\");\n\n  window.onload = function () {\n    localStorage.removeItem(\"loginMsg\");\n  }; //this resets the state on refreshing\n\n\n  useEffect(() => {\n    async function fetchData() {\n      const customer = (await axios.get(`http://localhost:8070/customer/profile/${id}`, {\n        withCredentials: true\n      })).data;\n      setfirstName(customer.fname);\n      setlastName(customer.lname);\n      setemail(customer.email);\n      setaddress(customer.address);\n      setphone(\"0\" + customer.pNo);\n    }\n\n    fetchData();\n  }, [id]);\n\n  const personalInfoForm = () => {\n    const inputFields = document.querySelectorAll(\"input[type='text']\");\n\n    for (let field = 0; field < inputFields.length; field++) {\n      inputFields[field].removeAttribute('disabled');\n    }\n\n    document.getElementById('updateButton').removeAttribute('hidden');\n    document.getElementById('cancelButton').removeAttribute('hidden');\n    document.getElementById('resetButton').setAttribute('hidden', 'true');\n    document.getElementById('editButton').setAttribute('hidden', 'true');\n  };\n\n  const editData = async e => {\n    e.preventDefault();\n    setemailerror('');\n    seterrors([]);\n    const response = await axios.post(`http://localhost:8070/customer/profile/update/${id}`, {\n      fname,\n      lname,\n      address,\n      pNo\n    }, {\n      withCredentials: true\n    });\n\n    if (response.data.success) {\n      const inputFields = document.querySelectorAll(\"input[type='text']\");\n\n      for (let field = 0; field < inputFields.length; field++) {\n        inputFields[field].setAttribute('disabled', 'true');\n      }\n\n      document.getElementById('updateButton').setAttribute('hidden', 'true');\n      document.getElementById('cancelButton').setAttribute('hidden', 'true');\n      document.getElementById('resetButton').removeAttribute('hidden');\n      document.getElementById('editButton').removeAttribute('hidden');\n      setsuccess('You have successfully updated your profile!');\n      props.history.push(\"/customer/profile\");\n    }\n\n    if (response.data.errors) {\n      seterrors(response.data.errors);\n    }\n\n    if (response.data.emailerror) {\n      setemailerror(response.data.emailerror);\n    }\n  };\n\n  const cancelUpdate = () => {\n    window.location = '/customer/profile';\n  };\n\n  const resetButton = () => {\n    props.history.push(\"/customer/profile/password-reset\");\n  };\n\n  const logoutHandler = () => {\n    if (window.confirm(\"Do you want to logout?\")) {\n      removeUser();\n      localStorage.setItem('logoutMsg', 'You have successfully logged out!');\n      window.location = '/customer/login';\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    id: \"it19184722-Profile\",\n    children: /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"form-group it19184722-myForm\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"User Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"btn-danger btn it19184722-red-btn\",\n        id: \"it19184722-logout-btn\",\n        onClick: logoutHandler,\n        children: \"Log out\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 17\n      }, this), errors ? errors.map(error => {\n        return /*#__PURE__*/_jsxDEV(\"div\", {\n          class: \"alert alert-danger\",\n          role: \"alert\",\n          children: error.msg\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 25\n        }, this);\n      }) : null, emailerror ? /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"alert alert-danger\",\n        role: \"alert\",\n        children: emailerror\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }, this) : null, loginMsg ? /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"alert alert-success\",\n        role: \"alert\",\n        children: loginMsg\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 17\n      }, this) : null, success ? /*#__PURE__*/_jsxDEV(\"div\", {\n        class: \"alert alert-success\",\n        role: \"alert\",\n        children: success\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 17\n      }, this) : null, /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"First Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"form-control\",\n        type: \"text\",\n        onChange: e => setfirstName(e.target.value),\n        value: fname,\n        disabled: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 132\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Last Name\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"form-control\",\n        type: \"text\",\n        onChange: e => setlastName(e.target.value),\n        value: lname,\n        disabled: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 115,\n        columnNumber: 131\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 117,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"form-control\",\n        type: \"email\",\n        value: email,\n        disabled: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 118,\n        columnNumber: 86\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Address\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 120,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"form-control\",\n        type: \"text\",\n        onChange: e => setaddress(e.target.value),\n        value: address,\n        disabled: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 132\n      }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n        children: \"Phone No\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"form-control\",\n        type: \"text\",\n        onChange: e => setphone(e.target.value),\n        value: pNo,\n        disabled: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 126\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"it19184722-btn-section\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"editButton\",\n          type: \"button\",\n          value: \"Edit Details\",\n          onClick: personalInfoForm,\n          className: \"it19184722-green-btn btn\",\n          style: {\n            marginRight: '5px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"resetButton\",\n          type: \"button\",\n          value: \"Reset Password\",\n          onClick: resetButton,\n          className: \"it19184722-trans-green-btn btn\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"updateButton\",\n          type: \"button\",\n          value: \"Update\",\n          onClick: editData,\n          className: \"it19184722-green-btn btn\",\n          style: {\n            marginRight: '5px'\n          },\n          hidden: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"cancelButton\",\n          type: \"button\",\n          value: \"Cancel\",\n          onClick: cancelUpdate,\n          className: \"btn-danger btn it19184722-red-btn\",\n          hidden: true\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 126,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 88,\n    columnNumber: 9\n  }, this);\n}\n\n_s(CustomerUserProfile, \"SKitGvrfbOpeUevLpv2zL+3IoGA=\");\n\n_c = CustomerUserProfile;\n\nvar _c;\n\n$RefreshReg$(_c, \"CustomerUserProfile\");","map":{"version":3,"sources":["C:/Users/Dilanka Nirmal/Downloads/Y3S1/SPM/Assignment/Origin_FlickPlix/FlickPlix/Frontend/src/components/customerUserProfile/customerUserProfile.js"],"names":["React","useState","useEffect","axios","getUser","removeUser","CustomerUserProfile","props","fname","setfirstName","lname","setlastName","email","setemail","address","setaddress","pNo","setphone","id","errors","seterrors","emailerror","setemailerror","loginMsg","localStorage","getItem","success","setsuccess","window","onload","removeItem","fetchData","customer","get","withCredentials","data","personalInfoForm","inputFields","document","querySelectorAll","field","length","removeAttribute","getElementById","setAttribute","editData","e","preventDefault","response","post","history","push","cancelUpdate","location","resetButton","logoutHandler","confirm","setItem","map","error","msg","target","value","marginRight"],"mappings":"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","sourcesContent":["import React, {useState,useEffect}  from 'react';\nimport axios from 'axios';\nimport {getUser, removeUser} from '../../utils/common';\nimport '../../css/it19184722.css';\n\n\nexport default function CustomerUserProfile(props) {\n    const [fname, setfirstName] = useState(\"\");\n    const [lname, setlastName] = useState(\"\");\n    const [email, setemail] = useState(\"\");\n    const [address, setaddress] = useState(\"\");\n    const [pNo, setphone] = useState(\"\");\n    const id = getUser();\n    const [errors, seterrors] = useState([]);\n    const [emailerror, setemailerror] = useState(\"\");   \n    const[loginMsg] = useState(localStorage.getItem(\"loginMsg\"));//this sets logout msg if any\n    const[success,setsuccess] = useState(\"\")\n\n    window.onload = function() {\n        localStorage.removeItem(\"loginMsg\")\n    }//this resets the state on refreshing\n\n  \n    useEffect(() => {\n        async function fetchData(){\n            const customer = (await axios.get(`http://localhost:8070/customer/profile/${id}`,{withCredentials: true})).data;\n            setfirstName(customer.fname);\n            setlastName(customer.lname); \n            setemail(customer.email); \n            setaddress(customer.address);  \n            setphone(\"0\"+customer.pNo);    \n        }\n        fetchData();\n    },[id])\n  \n    const personalInfoForm = () => {\n        const inputFields = document.querySelectorAll(\"input[type='text']\");\n        for(let field = 0 ; field < inputFields.length ; field++){\n            inputFields[field].removeAttribute('disabled');\n        }\n        document.getElementById('updateButton').removeAttribute('hidden');\n        document.getElementById('cancelButton').removeAttribute('hidden');\n        document.getElementById('resetButton').setAttribute('hidden', 'true');\n        document.getElementById('editButton').setAttribute('hidden','true');\n        \n    }\n\n    const editData = async(e) => {\n        e.preventDefault();\n        setemailerror('');\n        seterrors([]);\n        const response = await axios.post(`http://localhost:8070/customer/profile/update/${id}`,{fname,lname,address,pNo},{withCredentials: true});\n        if (response.data.success) {\n            const inputFields = document.querySelectorAll(\"input[type='text']\");\n            for(let field = 0 ; field < inputFields.length ; field++){\n                inputFields[field].setAttribute('disabled','true');\n            }\n            document.getElementById('updateButton').setAttribute('hidden','true');\n            document.getElementById('cancelButton').setAttribute('hidden','true');\n            document.getElementById('resetButton').removeAttribute('hidden');\n            document.getElementById('editButton').removeAttribute('hidden');\n            setsuccess('You have successfully updated your profile!');\n            props.history.push(\"/customer/profile\");\n        }\n        if (response.data.errors) {\n            seterrors(response.data.errors);\n        }\n        if(response.data.emailerror){\n            setemailerror(response.data.emailerror);\n        } \n    }\n    const cancelUpdate = () => {\n            window.location = '/customer/profile'\n    }\n\n    const resetButton = () => {\n        props.history.push(\"/customer/profile/password-reset\");\n    }\n    const logoutHandler = () => {\n        if(window.confirm(\"Do you want to logout?\")){\n            removeUser();\n            localStorage.setItem('logoutMsg', 'You have successfully logged out!');\n            window.location = '/customer/login'\n        }\n    }\n    return (\n\n        <div id=\"it19184722-Profile\">\n            <form className=\"form-group it19184722-myForm\">\n                <h2>User Profile</h2>\n                <button className=\"btn-danger btn it19184722-red-btn\" id=\"it19184722-logout-btn\" onClick={logoutHandler}>Log out</button>\n                {errors ? errors.map((error) => {\n                    return (\n                        <div class=\"alert alert-danger\" role=\"alert\">\n                            {error.msg}\n                      </div>\n                    )\n                }):null}\n                {emailerror ? \n                <div class=\"alert alert-danger\" role=\"alert\">\n                    {emailerror}\n                </div>: null}\n                {loginMsg ? \n                <div class=\"alert alert-success\" role=\"alert\">\n                {loginMsg}\n                </div> : null}\n                {success ? \n                <div class=\"alert alert-success\" role=\"alert\">\n                    {success}\n                </div>: null}\n                <label>First Name</label>\n                <input className=\"form-control\" type=\"text\" onChange={(e) => setfirstName(e.target.value)} value={fname} disabled/><br/>  \n\n                <label>Last Name</label>\n                <input className=\"form-control\" type=\"text\" onChange={(e) => setlastName(e.target.value)} value={lname} disabled/><br/>   \n\n                <label>Email</label>\n                <input className=\"form-control\" type=\"email\" value={email} disabled/><br/>\n\n                <label>Address</label>\n                <input className=\"form-control\" type=\"text\" onChange={(e) => setaddress(e.target.value)} value={address} disabled/><br/>\n\n                <label>Phone No</label>\n                <input className=\"form-control\" type=\"text\" onChange={(e) => setphone(e.target.value)} value={pNo} disabled/><br/> \n\n                <div className=\"it19184722-btn-section\">\n                    <input id=\"editButton\" type=\"button\" value=\"Edit Details\" onClick={personalInfoForm} className=\"it19184722-green-btn btn\" style={{marginRight:'5px'}}/>\n                    <input id=\"resetButton\" type=\"button\" value=\"Reset Password\" onClick={resetButton} className=\"it19184722-trans-green-btn btn\"/>\n                    <input id=\"updateButton\" type=\"button\" value=\"Update\" onClick={editData} className=\"it19184722-green-btn btn\" style={{marginRight:'5px'}} hidden/>\n                    <input id=\"cancelButton\" type=\"button\" value=\"Cancel\" onClick={cancelUpdate} className=\"btn-danger btn it19184722-red-btn\" hidden/>\n                </div>\n            </form>\n        </div>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}